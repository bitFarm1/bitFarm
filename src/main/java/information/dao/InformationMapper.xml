<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="informationSQL" >
	<!-- QnABoard (informationQnA)  -->
	<insert id="infoQnABoardWrite" parameterType="informationQnADTO">
		insert into QnABoard values(#{infoQnA_type},
									#{infoQnA_subject},
									#{infoQnA_userID}, 
									#{infoQnA_orderNum},  
									#{infoQnA_email},
									#{infoQnA_phone},
									#{infoQnA_content},
									nvl(#{infoQnA_imageName},'0'), 
									sysdate, 
									0, 
									0,
									sysdate,
									QnABoard_SEQ1.nextval)	   
	</insert> 
	
	<select id="getInfoList" parameterType="java.util.Map" resultType="informationQnADTO">
		<![CDATA[ 
		select * from (select rownum rn, tt.* from (select * from QnABoard order by infoQnA_seq desc)tt)where rn>=#{startNum} and rn<=#{endNum} and infoQnA_userid = #{memberId}
		]]> 
	</select> 	 
	
	<select id="getInfoListADMIN" parameterType="java.util.Map" resultType="informationQnADTO">
		<![CDATA[ 
		select * from (select rownum rn, tt.* from (select * from QnABoard order by infoQnA_seq desc)tt)where rn>=#{startNum} and rn<=#{endNum} and infoQnA_answerSubject = '0' 
		]]> 
	</select> 	 
	
	<select id="infoQnAListAllADMIN" parameterType="java.util.Map" resultType="informationQnADTO">
		<![CDATA[ 
		select * from (select rownum rn, tt.* from (select * from QnABoard order by infoQnA_seq desc)tt)where rn>=#{startNum} and rn<=#{endNum} 
		]]> 
	</select> 	     
	 
	<select id="writeQnAAnswer" parameterType="String" resultType="informationQnADTO">
		select * from QnABoard where infoQnA_seq = #{seq}
	</select>
	
	<update id="answerWrite" parameterType="java.util.Map">
		update QnABoard
		set infoQnA_answerSubject = #{infoQnA_answerSubject},
		infoQnA_answerContent = #{infoQnA_answerContent},
		infoQnA_answerDate = sysdate 
		where infoQnA_seq = #{seq}   
	</update>
	
	
	<!-- information (공지사항) !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
	<insert id="infoWrite" parameterType="informationDTO">
		insert into information values(information_SEQ.nextval,
								#{information_subject},
								#{information_name},
								sysdate,
								0,
								nvl(#{information_imageName},0),
								#{information_content}) 
	</insert>
	
	<select id="infoBoardList" parameterType="java.util.Map" resultType="informationDTO">
		<![CDATA[ 
		select * from (select rownum rn, tt.* from (select * from information order by information_number desc)tt)where rn>=#{startNum} and rn<=#{endNum}
		]]> 
	</select>
	
	<select id="infoView" parameterType="String" resultType="informationDTO">
		select * from information where information_number = #{seq}
	</select> 	 
	
	<select id="informationTotalA" resultType="int"><!-- 값 ? 에 넣는 타입  --><!--user.bean.UserDTO => user로 사용 mybatis-config.xml  -->
		select count(*) from information 
	</select>  
	
	<select id="getInfoSearch" parameterType="java.util.Map" resultType="informationDTO">
		<![CDATA[
			select * from  
			(select rownum rn, tt.* from
			(select * from information where ${searchOption} like '%'||#{keyword}||'%'
			) tt 
			)where rn >= #{startNum} and rn<= #{endNum} 
		]]>    
	</select>
	 
	<select id="getInfoSearchTotalA" parameterType="Map" resultType="int">
		select count(*) from information where ${searchOption} like '%'||#{keyword}||'%'  
	</select> 
	
</mapper>  